<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>butterfly_registrator Documentation</title>
            <link rel="icon" href="https://olive-groves.github.io/butterfly_registrator/images/registrator_logo.png"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3, .pdoc h4{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */.pdoc{--link:#0969da; --link-hover:#0969da; }.pdoc h1, .pdoc h2, .pdoc h3, .pdoc h4{margin:.3em 0;padding:.2em 0;margin-left:-1px;}.pdoc h1{font-weight:300;margin-top:1.2em;font-size:calc(1.75rem + 2vw)}@media (min-width:1200px){.pdoc h1{font-size:3.25rem}}.pdoc h2{font-weight:600;}.pdoc h3{font-weight:700;font-size:1.1rem;}.pdoc h4{font-weight:800;font-size:0.9rem;}.pdoc h2.nav{font-weight:300;}.pdoc a:hover{color:var(--link-hover);text-decoration:underline; }.pdoc pre{border:none;margin-top:1rem;margin-bottom:1rem;background-color:#fcfcfc;}.pdoc pre > code{color:#666666;}.pdoc img{max-width:100%; height:auto;}nav.pdoc{box-shadow:None; }nav.pdoc input[type=search]{margin-bottom:1.5rem;}nav.pdoc li a{font-size:90%; }nav.pdoc > div > ul > li > a{margin-top:0.5rem;font-size:110%;}.pdoc blockquote{color:var(--text); border-left:0.5rem solid hsl(60, 8%, 73%);padding:1rem 1rem 1rem 1rem;margin-left:1rem;margin-right:2rem;font-size:85%;background-color:hsl(60, 28%, 95%);;}.pdoc blockquote > p{margin-bottom:0.2rem;}</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>
<a href="https://olive-groves.github.io/butterfly_registrator/">            <img src="https://olive-groves.github.io/butterfly_registrator/images/registrator_logo.png" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

        <h2 class="nav">Butterfly Registrator</h2>
        <ul>
  <li><a href="#download-and-install">Download and install</a>
  <ul>
    <li><a href="#windows-executable">Windows executable</a></li>
    <li><a href="#python">Python</a></li>
  </ul></li>
  <li><a href="#tutorial">Tutorial</a>
  <ul>
    <li><a href="#download-sample-van-gogh-images">Download sample Van Gogh images</a></li>
    <li><a href="#register-individual-images">Register individual images</a></li>
    <li><a href="#batch-mode-register-multiple-at-once">Batch mode (register multiple at once)</a></li>
    <li><a href="#convert-to-alphascale-from-grayscale">Convert to alphascale from grayscale</a></li>
    <li><a href="#merge-multiple-alphascale">Merge multiple alphascale</a></li>
    <li><a href="#butterfly-viewer">Butterfly Viewer</a></li>
  </ul></li>
  <li><a href="#common-questions">Common questions</a>
  <ul>
    <li><a href="#report-a-bug">Report a bug?</a></li>
    <li><a href="#request-new-feature">Request new feature?</a></li>
    <li><a href="#how-does-registration-work">How does registration work?</a></li>
    <li><a href="#what-is-alphascale">What is alphascale?</a></li>
  </ul></li>
  <li><a href="#developers">Developers</a>
  <ul>
    <li><a href="#contributing-to-butterfly_registrator">Contributing to <code>butterfly_registrator</code></a></li>
    <li><a href="#creating-the-executable-and-setup-installer">Creating the executable and setup installer</a></li>
    <li><a href="#generating-documentation-with-pdoc">Generating documentation with pdoc</a></li>
    <li><a href="#updating-packages-in-environmentyml">Updating packages in <code>environment.yml</code></a></li>
  </ul></li>
  <li><a href="#credits">Credits</a></li>
  <li><a href="#license">License</a></li>
</ul>


<h2 class="nav">Modules</h2>    <ul>
        <li>
                    <li><a href="butterfly_registrator/butterfly_registrator.html">butterfly_registrator</a></li>
            <ul>
                        <li><a href="butterfly_registrator/alg_alphascale.html">alg_alphascale</a></li>
                        <li><a href="butterfly_registrator/aux_alphascale_creator.html">aux_alphascale_creator</a></li>
                        <li><a href="butterfly_registrator/aux_buttons.html">aux_buttons</a></li>
                        <li><a href="butterfly_registrator/aux_comments.html">aux_comments</a></li>
                        <li><a href="butterfly_registrator/aux_converter.html">aux_converter</a></li>
                        <li><a href="butterfly_registrator/aux_dialogs.html">aux_dialogs</a></li>
                        <li><a href="butterfly_registrator/aux_exif.html">aux_exif</a></li>
                        <li><a href="butterfly_registrator/aux_functions.html">aux_functions</a></li>
                        <li><a href="butterfly_registrator/aux_labels.html">aux_labels</a></li>
                        <li><a href="butterfly_registrator/aux_lineedits.html">aux_lineedits</a></li>
                        <li><a href="butterfly_registrator/aux_rulers.html">aux_rulers</a></li>
                        <li><a href="butterfly_registrator/aux_scenes.html">aux_scenes</a></li>
                        <li><a href="butterfly_registrator/aux_splitview.html">aux_splitview</a></li>
                        <li><a href="butterfly_registrator/aux_trackers.html">aux_trackers</a></li>
                        <li><a href="butterfly_registrator/aux_viewing.html">aux_viewing</a></li>
            </ul>
        </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
butterfly_registrator    </h1>

                        <div class="docstring"><p align="center">
  <big>
    <a href="#download-and-install">Download</a> 
    ·
    <a href="#tutorial">Tutorial</a>
    ·
    <a href="https://github.com/olive-groves/butterfly_registrator">GitHub↗</a>
    <br>
    <a href="https://github.com/olive-groves/butterfly_viewer">Butterfly Viewer↗</a>
  </big>
</p>

<p align="center">
  <img src="images/registrator_registration.gif" alt="Animated screencapture of the Butterfly Registrator showing a control point of a moving image being moved to match that of a reference image, the registration being applied, and the sliding overlay preview being moved to compare the registered image with the reference image.">
  <br />
  <i>Registering an XRF element map to a color image¹</i>
</p>

<p align="center">
  <img src="images/registrator_alphascale.gif" alt="Animated screencapture of the Butterfly Registrator showing an XRF map dragged into the alphascale converter, the color picker selector being changed, and the save alphascale shown in the Butterfly Viewer.">
  <br />
  <i>Alphascale conversion of grayscale XRF element maps¹, then shown in <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer</a></i>
</p>

<p>Butterfly Registrator is a preprocessing app for aligning images using pairs of control points you click and drag. It helps you align (or <a href="#how-does-registration-work"><em>register</em></a>) images to a given reference such that their heights and widths match and the features within those images line up, making it easy to later overlay and compare them without the hassle of manually zooming, stretching, and cropping them beforehand.</p>

<p>The Registrator also creates alphascale images. You can convert individual grayscale images using a color picker and also merge multiple alphascale images into a single image.</p>

<p>The Registrator runs as an <a href="#windows-executable">installable Windows executable</a> or directly on its <a href="#python">Python source code</a>.</p>

<p>Most types of PNG, JPEG, and TIFF can be loaded into the Registrator. It can likewise save registered image files to PNG, JPEG, and TIFF.</p>

<p>With <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer<sup>↗</sup></a> you can rapidly compare your registered images with sliding overlays and synchronized side-by-side pan and zoom. The Viewer is handy for visually inspecting painting research data such as high-res and raking-light photos, X-rays, and element maps from XRF and RIS — especially with element maps <a href="#convert-to-alphascale-from-grayscale">converted to alphascale</a>.</p>

<h3 id="key-features">Key features</h3>

<ul>
<li><p><strong>Side-by-side image previews</strong> to rapidly check the accuracy of registration and make adjustments before saving a copy.</p></li>
<li><p><strong>Batch mode</strong> to apply the same registration to multiple images of the same capture/perspective, which is useful for registering element maps from scanning X-ray fluorescence (XRF) and reflectance imaging spectroscopy (RIS) to a ground truth like a color photograph.</p></li>
<li><p><strong>Save registration control points to CSV</strong> to easily document and trace the images you register, and import later if you want to reproduce or adjust a registration.</p></li>
</ul>

<p><sup>¹<em>Small Pear Tree in Blossom</em> by Vincent van Gogh (Van Gogh Museum, Amsterdam)</sup></p>

<h1 id="download-and-install">Download and install</h1>

<p>You can download and install Butterfly Registrator to run:</p>

<ul>
<li>as a <a href="#windows-executable">Windows executable</a>; or </li>
<li>directly with <a href="#python">Python</a>.</li>
</ul>

<h2 id="windows-executable">Windows executable</h2>

<blockquote>
  <p>Download: <a href="https://github.com/olive-groves/butterfly_registrator/releases/latest"><code>butterfly_registrator_v1.y.z_win64_setup.exe.zip</code><sup>↗</sup></a></p>
  
  <p><sup> <strong>Restart recommended</strong> · <strong>230 MB installed</strong></sup></p>
</blockquote>

<p>For Windows, Butterfly Registrator installs to your computer with an executable (.exe) installer similar to how other programs install on your computer. The Registrator will be added to your list of programs and optionally to your desktop as a shortcut.</p>

<p>Here v1.0.0 is shown in the screenshots, but you should use the <a href="https://github.com/olive-groves/butterfly_registrator/releases/latest">latest version</a> unless advised otherwise.</p>

<p><img src="images/install/windows_shortcut.jpg" alt="Butterfly Registrator shortcut and icon on Windows" /></p>

<h3 id="prerequisites">Prerequisites</h3>

<ul>
<li><p>The Registrator executable only runs on Windows. There's currently no support for executables for Linux or macOS.</p></li>
<li><p>The Registrator uses 230 MB of storage space as an installed app.</p></li>
<li><p>The Registrator uses locally stored images (like PNG, JPEG, TIFF) to load for registration and alphascale creation. It's designed to be navigated by mouse or trackpad by clicking, dragging, and dropping.</p></li>
<li><p>The Registrator doesn't use the internet, so any online images you wish to use must be locally available — for example, by downloading them or by selecting “always keep on your device” if they sync to cloud storage like OneDrive or Google Drive. Images on network shares can be loaded into the Registrator, but they can take more time to load than those stored locally, especially if accessing the share through a VPN.</p></li>
</ul>

<h3 id="download-zip">Download ZIP</h3>

<p>Download the Registrator from the latest release of the Registrator's GitHub repo, which is packaged as an installer under <em>Assets</em> as <a href="https://github.com/olive-groves/butterfly_registrator/releases/latest"><code>butterfly_registrator_v1.y.z_win64_setup.exe.zip</code><sup>↗</sup></a>.</p>

<p><img src="images/install/download_zip.jpg" alt="Screenshot showing the download link of the Butterfly Registrator installer ZIP on its GitHub repo." />
<br>
<sup>Here v1.0.0 is shown, but you should download the <a href="https://github.com/olive-groves/butterfly_registrator/releases/latest">latest version</a>.</sup></p>

<h3 id="extract-zip">Extract ZIP</h3>

<p>Extract <code>butterfly_registrator_v1.y.z_win64_setup.exe</code> from the ZIP:</p>

<ol>
<li>Go to the folder where you downloaded the ZIP.</li>
<li>Right-click the ZIP.</li>
<li>Select <strong>Extract All...</strong> or another extraction tool (like 7-Zip).</li>
</ol>

<p><img src="images/install/extract_zip.jpg" alt="Sequence of screenshots showing how to extract the Butterfly Registrator installer executable from the ZIP." /></p>

<h3 id="run-installer">Run installer</h3>

<p><strong>Heads-up:</strong> Your computer might block you from running the installer via double-click if you’re using a work computer or otherwise don’t have admin privileges:</p>

<ul>
<li>If you have no admin privileges, skip to <a href="#option-2-without-admin-privileges">Option 2</a>. </li>
<li>If you indeed have admin privileges, just follow <a href="#option-1-with-admin-privileges">Option 1</a>.</li>
</ul>

<blockquote>
  <p><em>Why is it unrecognized and blocked?  In short, it’s because this installer has no certificate. If an installer's certificate isn't found by Windows when double-clicked, Windows will block it from immediately running.</em></p>
</blockquote>

<h4 id="option-1-with-admin-privileges">Option 1: With admin privileges</h4>

<p>If you have admin privileges, run the installer by double-clicking on <code>butterfly_registrator_v1.y.z_win64_setup.exe</code>:</p>

<ol>
<li>Double-click on <code>butterfly_registrator_v1.y.z_win64_setup.exe</code>.</li>
<li>Select <strong>More info</strong>.</li>
<li>Select <strong>Run anyway</strong>.
<br>
<sup>No <strong>Run anyway</strong>? Select <strong>Don't run</strong> and <a href="#option-2-without-admin-privileges">try Option 2.</a></sup></li>
<li>Wait for the installer to load. This may take a few seconds.</li>
</ol>

<p><img src="images/install/install_admin.jpg" alt="Sequence of screenshots showing how to run the Butterfly Registrator installer by double-clicking it." /></p>

<h4 id="option-2-without-admin-privileges">Option 2: Without admin privileges</h4>

<p>If double-clicking the installer doesn’t work, run the installer via the command prompt.</p>

<blockquote>
  <p><em>Not possible? You can try installing on a virtual machine or contacting your machine admin.</em></p>
</blockquote>

<p>You can find various ways online on how to run an executable (EXE) via the command prompt, but I prefer these steps:</p>

<ol>
<li>Copy the path of the installer:
<ul>
<li>Press and hold the <code>Shift</code> key and then <strong>right-click</strong> the file. Wait for the menu to load.</li>
<li>Select <strong>Copy as path</strong>.</li>
</ul></li>
</ol>

<ol start="2">
<li>Open the Start menu  (<code>⊞ Win</code>).</li>
<li>Type <strong>cmd</strong>.</li>
<li>Press the <code>Enter</code> key or select the Command Prompt app.</li>
<li>Paste into the prompt the installer path you copied with <code>Ctrl·V</code>.</li>
<li>Run by pressing <code>Enter</code>. </li>
<li>Wait for the installer to load. This may take a few seconds.</li>
</ol>

<p><img src="images/install/install_cmd.jpg" alt="Sequence of screenshots showing how to run the Butterfly Registrator installer with the command prompt." />   </p>

<h3 id="follow-installer-steps-and-install">Follow installer steps and install</h3>

<p>Once the installer loads, follow the onscreen steps to install the Registrator:</p>

<ul>
<li>Accept the agreement. The license is <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU GPL v3.0<sup>↗</sup></a> or later.</li>
<li>Choose to create a desktop shortcut. This can be useful to have.</li>
<li>Choose the install folder. The default should be ok.
<br></li>
</ul>

<blockquote>
  <p>*Updating with a newer version? First <a href="#uninstall">uninstall the old version</a> and then re-run the new installer.</p>
</blockquote>

<ul>
<li>Install.</li>
<li>Restart. <strong>Restart recommended</strong> to avoid issues with drag-and-drop not working.</li>
</ul>

<p><img src="images/install/install_installer.jpg" alt="Two screenshots of the Butterfly Registrator installer: 1) the first page showing the license agreement, and 2) the final page confirming a completed install." />   </p>

<h3 id="run">Run</h3>

<p>To run the Registrator, search for <strong>Butterfly Registrator</strong> in the Start menu (<code>⊞ Win</code>) or double-click on the desktop shortcut if you added it upon install.</p>

<p><a href="#tutorial">Follow the tutorial</a> to learn the Registrator's features.</p>

<p><img src="images/tutorial/start_registrator.jpg" alt="Sequence of screenshots showing a Start menu search for &quot;Butterfly Registrator&quot; with the installed app as the first result and the app's desktop shortcut, with arrows from both pointing at the Registrator's empty startup screen." /></p>

<h3 id="uninstall">Uninstall</h3>

<p>You can uninstall the Registrator executable from Windows by going to <strong>Add or remove programs</strong> via the Start menu, selecting <strong>Butterfly Registrator</strong>, and then selecting <strong>Uninstall</strong>. </p>

<hr />

<h2 id="python">Python</h2>

<p>Butterfly Registrator also runs directly on its Python source code, available from its <a href="https://github.com/olive-groves/butterfly_registrator">GitHub repo<sup>↗</sup></a>:</p>

<pre><code>python butterfly_registrator.py
</code></pre>

<h3 id="requirements">Requirements</h3>

<p>The list of dependencies are in <code>environment.yml</code> in the root directory, which includes:</p>

<ul>
<li>Python 3.6 (tested with Python 3.6.13) </li>
<li>PyQt 5.9 (tested with PyQt 5.9.2)</li>
<li>OpenCV 3.4 (tested with OpenCV 3.4.2)</li>
</ul>

<h3 id="install-and-run">Install and run</h3>

<p>There are a couple ways to run the Registrator with Python. Here's one way using conda (<a href="https://anaconda.org/">anaconda.org<sup>↗</sup></a>):</p>

<ol>
<li>Clone Butterfly Registrator from its <a href="https://github.com/olive-groves/butterfly_registrator">GitHub repo<sup>↗</sup></a> or simply download the source code as a ZIP and extract it.</li>
<li>Note the root directory <code>C:\path\to\the\butterfly_registrator\</code>.</li>
<li><p>Open Anaconda Prompt and change the directory to the root directory.</p>

<pre><code>cd C:\path\to\the\butterfly_registrator\
</code></pre></li>
<li><p>Create a new conda environment in a new subfolder named <code>env</code> using the <code>environment.yml</code> file from the root directory.</p>

<pre><code>conda env create --file environment.yml --prefix ./env
</code></pre></li>
<li><p>Activate the <code>env</code> environment.</p>

<pre><code>conda activate ./env
</code></pre></li>
<li><p>Change directory to the source subfolder.</p>

<pre><code>cd butterfly_registrator
</code></pre></li>
<li><p>Run Butterfly Registrator.</p>

<pre><code>python butterfly_registrator.py
</code></pre></li>
</ol>

<h1 id="tutorial">Tutorial</h1>

<blockquote>
  <p>Sample images: <a href="https://vgm.data.surfsara.nl/index.php/s/S3b4dnayUDKHtLA"><code>VGM_Datapackage_2023000_Butterfly_Images_V20231003.zip</code><sup>↗</sup></a></p>
  
  <p><sup><strong>Credits: Van Gogh Museum, Amsterdam</strong> · <strong>133 MB extracted</strong></sup></p>
</blockquote>

<p>This tutorial shows you how to register images with the Butterfly Registrator using a stack of sample technical images of Vincent van Gogh's <em>Small Pear Tree in Blossom</em>. We'll also cover how to convert grayscale images to alphascale and merge multiple alphascale images, all within the Registrator.</p>

<h2 id="download-sample-van-gogh-images">Download sample Van Gogh images</h2>

<p>Download the <a href="https://vgm.data.surfsara.nl/index.php/s/S3b4dnayUDKHtLA">ZIP of sample technical images<sup>↗</sup></a> of <em>Small Pear Tree in Blossom</em> by Vincent van Gogh, with credits to the Van Gogh Museum, Amsterdam.</p>

<p><img src="images/tutorial/download_images.jpg" alt="Screenshot of the download button for the tutorial's sample images." /></p>

<p>Extract the ZIP and open the folder of images. <sup>How to: <a href="#extract-zip">Extract a ZIP</a></sup></p>

<p><img src="images/tutorial/images_folder.jpg" alt="Screenshot of the images folder from the downloaded sample ZIP." /></p>

<h2 id="register-individual-images">Register individual images</h2>

<p align="center">
  <img src="images/registrator_registration.gif" alt="Animated screencapture of the Butterfly Registrator showing a control point of a moving image being moved to match that of a reference image, the registration being applied, and the sliding overlay preview being moved to compare the registered image with the reference image.">
  <br />
  <i>Registering an XRF element map to a color image¹</i>
</p>

<p>Let's start by registering one image to another image so we can accurately compare them.</p>

<p>Specifically, from the sample images of <em>Small Pear Tree in Blossom</em>, we'd like to directly compare the grayscale element map of zinc (created using scanning X-ray fluorescence, or <em>XRF</em>) with the high-resolution color photograph. That is:</p>

<ul>
<li><code>s0039V1962_Zn_MAXRF.png</code>; and</li>
<li><code>s0039V1962_b_crop.png</code></li>
</ul>

<p>However, the dimensional mismatch of the two images means that we can't overlay them or arrange them side by side for comparison without manipulating one or the other. </p>

<p><img src="images/tutorial/register_not_aligned.jpg" alt="Screenshot of the Butterfly Viewer showing the sample color photograph next to the original zinc element map to scale." /></p>

<p>In other words, before we can accurately compare the two images, the zinc map needs to be resized, padded, and warped such that its features align 1:1 with those in the color photo. </p>

<p>We'll use the Registrator to do all of that alignment — the <em>registration</em> — simply by using four pairs of control points which we'll position on the two images.</p>

<blockquote>
  <h3 id="how-it-works">How it works</h3>
  
  <p>Registration works by first designating a reference image, loading the image you wish to align (<em>register</em>) to that reference, automatically resizing and padding it to the dimensions of that reference, and finally applying a perspective transform to match the pairs of control points which you position on both images.</p>
  
  <p><br></p>
  
  <p><img src="images/tutorial/illustrate_registration.jpg" alt="Illustration of how registration is done in the Registrator." /></p>
  
  <p><img src="images/tutorial/illustrate_registrator.jpg" alt="Illustration itself shown in the Registrator." /></p>
</blockquote>

<p>First, start the Registrator.</p>

<ul>
<li>If you installed the Windows executable, search for <strong>Butterfly Registrator</strong> in the Start menu (<code>⊞ Win</code>) or double-click on its desktop shortcut. 
<br><sup>How to: <a href="#run">Run installed executable</a></sup></li>
<li>If you're using Python, execute <code>python butterfly_viewer</code>.
<br><sup>How to: <a href="#install-and-run">Run on Python</a></sup></li>
</ul>

<p><img src="images/tutorial/started.jpg" alt="Screenshot of the Registrator's empty startup screen." /></p>

<p>The reference image always needs to be added first in the Registrator. That is, we must first give the Registrator the image to which we would like to align the other image(s). </p>

<p>We'll use the high-resolution color image as our reference. It has far greater detail* than the zinc element map, and as a photograph it is a (relatively) easily referenceable ground-truth for registering other modalities of <em>Small Pear Tree in Blossom</em> such as raking light, X-ray, ultraviolet, and infrared images.</p>

<blockquote>
  <h3 id="selecting-the-reference">Selecting the reference</h3>
  
  <p>It's usually best to select the image with the highest visible detail as reference in order to keep those details. The reference image is untouched during registration, whereas the image to be registered is modified such that it has the same dimensions as that of the reference.</p>
  
  <p>If we were to register the other way — that is, use the smaller and lower detail zinc map as reference — the Registrator would greatly reduce the size of the photograph to align it with the map. More broadly, registering a large image to a small image will cause the large image to be downsampled, therefore losing valuable detail for later use.</p>
</blockquote>

<p>Click and drag <code>s0039V1962_b_crop.png</code> from the sample images folder into the Registrator as the reference.</p>

<p><img src="images/tutorial/register_drag_reference.jpg" alt="Screenshot of the color photograph of Small Pear Tree in Blossom dragged into the reference spot of the Registrator." /></p>

<p>Next, click and drag <code>s0039V1962_Zn_MAXRF.png</code> into the Registrator as the image to be registered.</p>

<p><img src="images/tutorial/register_drag_toregister.jpg" alt="Screenshot of the zinc element map of Small Pear Tree in Blossom dragged into the spot to be registered of the Registrator." /></p>

<p>The color photo is now loaded as our reference image, and the zinc map is now loaded as a resized and padded image to be registered.</p>

<blockquote>
  <p>You might have noticed the sample folder already contains registered copies of the element maps. Those are available for you to jump into other tutorials without needing to register the maps yourself. But since that's what we're doing here, you can ignore them.</p>
</blockquote>

<p><img src="images/tutorial/register_control_point_default.jpg" alt="Screenshot of the Registrator with reference and to-be-registered images loaded with default control point placement." /></p>

<p>By default, the four control points that were automatically placed on each image are arbitrarily set within the image bounds. The Registrator itself doesn't position them to match actual features within the images — that's our job.</p>

<p>Click and drag the control points on the two images such that each pair corresponds to the approximate position of a distinct matching feature. For example, the:</p>

<ol>
<li>blossom on the far left of the tree;</li>
<li>top-right corner of the brick wall in the background;</li>
<li>blossom on the bottom left; and</li>
<li>branches crossing over each to the right of the trunk.</li>
</ol>

<p>Zoom (scroll) and pan (left-click drag) the images for more precise placement.</p>

<p><img src="images/tutorial/register_control_point_rough.jpg" alt="Screenshot of the Registrator with control points roughly placed on the reference and to-be-registered images at four distinct features." /></p>

<p>Click 'Apply' to register the zinc map with the current control points. The registered map and reference image will automatically open in a sliding overlay preview on the right.</p>

<p><img src="images/tutorial/register_apply.jpg" alt="Screenshots of the Registrator showing the registration being applied with the current control points." /></p>

<p>If you zoom into the preview and compare various areas of the registered map and reference image, you may see the registration is not as accurate as we'd like it to be. We'll need to iterate on our control point placement.</p>

<p>Refine the placement of the control points and reapply the registration until there is little variation in the position of features between the two images. </p>

<h3 id="registration-tips">Registration tips</h3>

<ul>
<li><p>Experiment and iterate on different features to refine the registration.</p></li>
<li><p>Sharp lines, corners, and intersections in the features provide opportunities for more precise placement of control points compared to gradients and blurry/non-detailed regions. </p></li>
<li><p>Place pairs of control points as far apart from one another (and as far from the image center) to reduce the effect of placement error in the warp perspective transform.</p></li>
<li><p>If you attempt to register a stitched image or an image produced using individually collected points of information (like scanning XRF) to a reference image created from a single perspective (like a photograph), there may be a limit to how well you can align all features in that image. If you need more locally accurate registration in this regard, look into affine or elastic (non-rigid) image registration, such as that provided by SimpleElastix.</p></li>
</ul>

<p>Below are examples of the four positions with their respective coordinates. Can you do better?</p>

<p><img src="images/tutorial/register_control_point_1.jpg" alt="Screenshot of the Registrator zoomed to the first control point pair." /></p>

<pre><code>Control point 1
                        x         y
Reference          416.05   1591.30
To be registered   212.19   1051.65
</code></pre>

<p><img src="images/tutorial/register_control_point_2.jpg" alt="Screenshot of the Registrator zoomed to the second control point pair." /></p>

<pre><code>Control point 2
                        x         y
Reference         4212.88   1386.93
To be registered  2325.54    938.58
</code></pre>

<p><img src="images/tutorial/register_control_point_3.jpg" alt="Screenshot of the Registrator zoomed to the third control point pair." /></p>

<pre><code>Control point 3
                        x         y
Reference         1087.41   3280.87
To be registered   582.69   1991.58
</code></pre>

<p><img src="images/tutorial/register_control_point_4.jpg" alt="Screenshot of the Registrator zoomed to the fourth control point pair." /></p>

<pre><code>Control point 4
                        x         y
Reference         3065.71   4287.46
To be registered  1677.97   2554.12
</code></pre>

<p>Click 'Save as...' to open the save dialog for the registered zinc map. </p>

<p><img src="images/tutorial/register_save.jpg" alt="Screenshot of the Registrator indicating the 'Save as...' button." /></p>

<p>Create a new folder named 'My registered images'in the sample images folder.</p>

<p>Navigate to that subfolder, keep the default* basename, and click 'Save'.</p>

<blockquote>
  <p>*The default basename of the registered image is the original name appended by the reference name: <code>ORIGINAL_registered_to_REFERENCE</code>. We recommend keeping this convention (or something similar) to explicitly communicate to yourself and to others that the image is a version of the original image which has been aligned to another image.</p>
</blockquote>

<p><img src="images/tutorial/register_save_dialog.jpg" alt="Screenshot of the save dialog showing a new folder created named 'My registered images'." /></p>

<p>The Registrator will always ask if you want to auto-save the control points when saving registered images. This creates a small CSV file (&lt; 1 KB) to the same folder as the saved image and contains metadata on the registration, making it easy to document and trace the images you register and later load the control points if you want to reproduce or adjust a registration.</p>

<p>Click 'Auto-save control points' in the next dialog to save the registration metadata alongside the image file.</p>

<p><img src="images/tutorial/register_autosave_dialog.jpg" alt="Screenshot of the control point auto-save dialog." /></p>

<p><img src="images/tutorial/register_csv.jpg" alt="Screenshot of the registration CSV opened in a text editor a new folder created named 'My registered images'." /></p>

<p>The original zinc element map is now registered — but what about registering the other maps? Well, since they were generated from the same capture as the zinc map, we can simply register them as a batch using the existing control points.</p>

<p>To learn about the batch mode in the Registrator, keep the app open and proceed to the next part of the tutorial.</p>

<h2 id="batch-mode-register-multiple-at-once">Batch mode (register multiple at once)</h2>

<blockquote>
  <p>Batch mode only works when the selected images have the same height and width as the image which was loaded to be registered.</p>
</blockquote>

<p><img src="images/tutorial/batch_unregistered.jpg" alt="Screenshot of the control point auto-save dialog." /></p>

<p><img src="images/tutorial/batch_registered.jpg" alt="Screenshot of the control point auto-save dialog." /></p>

<p>Now let's use batch mode to register all original XRF element maps to the color photograph of <a href="#download-sample-van-gogh-images"><em>Small Pear Tree in Blossom</em></a> at once. This skips having to register each map individually.</p>

<p>We'll use the registration from <a href="#register-individual-images">the previous part of the tutorial</a> as a sort of template — namely, in that the control points of the zinc map will define the registration for the entire batch of images we'd like to register. We can do this because the zinc map was generated from the same XRF scanning capture as the bromine and chromium maps, meaning we can apply the same registration to all three of them.</p>

<p>First, make sure you have the Registrator open with the following:</p>

<ul>
<li><p>the color photograph <code>s0039V1962_b_crop.png</code> loaded as reference;</p></li>
<li><p>the zinc map <code>s0039V1962_Zn_MAXRF.png</code> loaded to be registered; and</p></li>
<li><p>the control points* positioned on the two images as done in <a href="#register-individual-images">the previous part of the tutorial</a>.</p></li>
</ul>

<blockquote>
  <p>*To skip manually placing the control points, you can <a href="Registration_points-s0039V1962_Zn_MAXRF-to-s0039V1962_b_crop.csv">download a copy of the control points CSV</a> and load it in the Registrator with 'Load control points from .csv...'.</p>
</blockquote>

<p><img src="images/tutorial/batch_start.jpg" alt="Screenshot of the Registrator ready for batch mode." /></p>

<p>Click the checkbox for 'Enable batch registration'.</p>

<p>Click 'Select image(s)...'.</p>

<p><img src="images/tutorial/batch_enable_images.jpg" alt="Screenshot of the Registrator indicating the batch mode enabled and the button to select image(s)." /></p>

<p>Select the original element maps in the open dialog by holding Ctrl while left-clicking each file individually:</p>

<ul>
<li><p><code>s0039V1962_Br_MAXRF.png</code> (bromine);</p></li>
<li><p><code>s0039V1962_Cr_MAXRF.png</code> (chromium); and</p></li>
<li><p><code>s0039V1962_Zn_MAXRF.png</code> (zinc).</p></li>
</ul>

<p>Click 'Open'.</p>

<p><img src="images/tutorial/batch_images_select.jpg" alt="Screenshot of the Registrator showing the XRF element map files selected in the open dialog for batch mode." /></p>

<p>Click 'Select destination folder...'.</p>

<p><img src="images/tutorial/batch_destination.jpg" alt="Screenshot of the Registrator indicating the button to select the destination folder for the batch." /></p>

<p>Create a new folder named 'My batch registered images' in the sample images folder.</p>

<p>Select that subfolder and click 'Open'.</p>

<p><img src="images/tutorial/batch_destination_select.jpg" alt="Screenshot of the Registrator showing an open dialog with a new folder created named 'My batch registered images'." /></p>

<p>We've now selected the images we wish to register along with the destination folder in which to save those registered images.</p>

<p>Click 'Register and save batch'.</p>

<p><img src="images/tutorial/batch_save.jpg" alt="Screenshot of the Registrator indicating the button to register and save the batch." /></p>

<blockquote>
  <p>Though it shouldn't happen in this tutorial, the Registrator will warn you if you attempt to register and save a batch of images if the destination folder already contains registered versions of those images.</p>
  
  <p><br></p>
  
  <p><img src="images/tutorial/batch_overwrite.jpg" alt="Screenshot of the Registrator showing overwrite warning for batch mode." /></p>
</blockquote>

<p>The batch registration should be successful.</p>

<p>Click 'Close'.</p>

<p><img src="images/tutorial/batch_success.jpg" alt="Screenshot of the Registrator showing successful batch registration." /></p>

<p>As we saw earlier, the Registrator will always ask if you want to auto-save the control points when saving registered images. This includes batch mode, and the result will again be a single CSV file (&lt; 1 KB) saved to the same folder as the destination. It will contain the list of all images registered in the batch along with other metadata.</p>

<p>Click 'Auto-save control points' in the next dialog to save the registration metadata alongside the images.</p>

<p><img src="images/tutorial/batch_autosave.jpg" alt="Screenshot of the Registrator showing the dialog for autosaving the batch registration metadata." /></p>

<p>The destination folder should now contain the three registered element maps saved with their original filetype (here PNG) along with the control point CSV. </p>

<p>The basename of each batch-registered image is its original name appended by the reference name as <code>ORIGINAL_registered_to_REFERENCE</code>. This is the default setting for Registrator and currently cannot be modified through the app's interface. If you need to rename large quantities of files quickly, there are existing apps such as <a href="https://www.bulkrenameutility.co.uk/">Bulk Rename Utility<sup>↗</sup></a>.</p>

<p><img src="images/tutorial/batch_result.jpg" alt="Screenshot of the Registrator showing the dialog for autosaving the batch registration metadata." /></p>

<p>Keep the Registrator open if you want to learn how to convert the element maps to alphascale in the next part of the tutorial.</p>

<h2 id="convert-to-alphascale-from-grayscale">Convert to alphascale from grayscale</h2>

<p align="center">
  <img src="images/registrator_alphascale.gif" alt="Animated screencapture of the Butterfly Registrator showing an XRF map dragged into the alphascale converter, the color picker selector being changed, and the save alphascale shown in the Butterfly Viewer.">
  <br />
  <i>Alphascale conversion of grayscale XRF element maps¹, then shown in <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer</a></i>
</p>

<p>Here we'll convert the registered element maps of <a href="#download-sample-van-gogh-images"><em>Small Pear Tree in Blossom</em></a> from grayscale PNG to alphascale PNG using the Registrator.</p>

<blockquote>
  <h3 id="alphascale">Alphascale?</h3>
  
  <p>Alphascale is a term we use to refer to a grayscale image converted such that the transparency of each pixel (the <em>alpha channel</em>) is proportional to how black or white the original grayscale pixel is. Here are <a href="#what-is-alphascale">technical details</a>.</p>
  
  <p><br></p>
  
  <p><img src="images/tutorial/alphascale.png" alt="Gradient bar from white to black in grayscale, white alphascale, and red alphacale." /></p>
  
  <p><br></p>
  
  <p>When converted from grayscale to alphascale, an image showing the relative distribution of a feature can then be laid over a reference image. This makes it easier to see where the feature is distributed in the context of the reference. Sliding overlays in <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer<sup>↗</sup></a> benefit especially from using alphascale versions of grayscale images such as XRF and RIS maps.</p>
  
  <p><br></p>
  
  <p><img src="images/viewer_alphascale_overlay.gif" alt="Animated screencapture of the Butterfly Viewer showing a sliding overlay with four alphascale element maps being panned and zoomed." /></p>
</blockquote>

<p>To start, make sure you have the Registrator open with the tab 'Alphascale' selected and the tab 'Create single' selected therein.</p>

<p><img src="images/tutorial/alphascale_start.jpg" alt="Screenshot of the Registrator at the tab for creating single alphascale images." /></p>

<p>We're going to individually convert each of the element maps which we batch-registered in the <a href="#batch-mode-register-multiple-at-once">previous tutorial step</a>, starting with chromium.</p>

<p>Drag the registered chromium map <code>s0039V1962_Cr_MAXRF_registered_to_s0039V1962_b_crop.png</code> into the drop zone.</p>

<blockquote>
  <p>The sample images ZIP itself comes with registered copies of the element maps. You can use those if you didn't do the previous tutorial steps.</p>
</blockquote>

<p><img src="images/tutorial/alphascale_drag.jpg" alt="Screenshot of the registered chromium map of Small Pear Tree in Blossom dragged into the alphascale creator of the Registrator." /></p>

<p>Once loaded into the converter, the Registrator will show a preview of the grayscale image in alphascale with the color picker's current color. You can zoom and pan the preview to inspect details of the image. </p>

<blockquote>
  <p>The gray areas you see in the alphascale image aren't the image itself, but rather the gray background of the preview window seen through the transparent pixels of the image.</p>
</blockquote>

<p>Click and drag the selector of the color picker to green.</p>

<p><img src="images/tutorial/alphascale_color_picker.jpg" alt="Screenshot of the alphascale chromium map with green selected in the color picker of the Registrator's alphascale converter." /></p>

<p>Selecting a bright alphascale color will make it easier to see if laid over a reference image, like a color photograph.</p>

<blockquote>
  <h3 id="slow-color-picker">Slow color picker?</h3>
  
  <p>The larger the image to convert, the longer it takes to generate the preview. If the color picker is too slow when dragging the selector, uncheck 'Instantly apply'. You will then need to click 'Apply' each time to preview the alphascale image with the selected color.</p>
  
  <p><br></p>
  
  <p><img src="images/tutorial/alphascale_instant_apply.jpg" alt="Screenshot of the 'Instantly apply' checkbox checked and unchecked in the Registrator's alphascale converter." /></p>
</blockquote>

<p>Now let's save the alphascale. You'll notice that we can only save it as PNG or TIFF image type because they support an alpha channel, whereas JPEG does not.</p>

<p>Follow these steps:</p>

<ul>
<li><p>Click 'Save as...'.</p></li>
<li><p>Create a new folder named 'My alphascale images' in the sample images folder.</p></li>
<li><p>Navigate to that subfolder and leave the default basename unchanged.</p></li>
<li><p>Click 'Save'.</p></li>
</ul>

<p><img src="images/tutorial/alphascale_save.jpg" alt="Screenshot of the save dialog for the alphascale converter with a new folder created named 'My alphascale images'." /></p>

<blockquote>
  <p>The default basename of an alphascale-converted image is the original name appended by its color in RGB: <code>ORIGINAL_alphascale_rgb_RED_GREEN_BLUE</code>. <strong>We recommend keeping this convention</strong> (or something similar) to explicitly communicate to yourself and to others that the image is a version of the original image which has been converted to alphascale.</p>
</blockquote>

<p>Close the preview with the X.</p>

<p><img src="images/tutorial/alphascale_close.jpg" alt="Screenshot of the alphascale converter preview X button to close." /></p>

<p>Now convert and save the other two registered element maps (bromine and zinc) to alphascale with these colors:</p>

<ul>
<li><code>s0039V1962_Br_MAXRF_registered_to_s0039V1962_b_crop.png</code> with bright red; and</li>
<li><code>s0039V1962_Zn_MAXRF_registered_to_s0039V1962_b_crop.png</code> with white.</li>
</ul>

<p><img src="images/tutorial/alphascale_bromine.jpg" alt="Screenshot of the bromine map in the alphascale converter with a bright red color selected." /></p>

<p><img src="images/tutorial/alphascale_zinc.jpg" alt="Screenshot of the zinc map in the alphascale converter with a white color selected." /></p>

<p>In the next tutorial step, we'll merge the three into one alphascale image.</p>

<h2 id="merge-multiple-alphascale">Merge multiple alphascale</h2>

<p align="center">
  <img src="images/registrator_alphascale_merge.gif" alt="Animated screencapture of the Butterfly Registrator showing three alphascale XRF maps dragged into alphascale merger with the merged result.">
  <br />
  <i>Alphascale merging of three alphascale XRF element maps</i>
</p>

<p>Now let's convert merge the alphascale-converted element maps of <a href="#download-sample-van-gogh-images"><em>Small Pear Tree in Blossom</em></a> into one alphascale image.</p>

<blockquote>
  <h3 id="merge-alphascale">Merge alphascale?</h3>
  
  <p>Merging (a.k.a <em>adding</em> or <em>blending</em>) alphascale images is useful for showing the presence and overlap of features present in different alphascale images such as XRF and RIS element maps. </p>
  
  <p>The Registrator merges alphascale images by adding the color at each pixel using their respective alpha channel values as weight and setting the alpha channel of each pixel to the highest of those alpha channels. </p>
  
  <p>In other words, the color of a merged alphascale pixel represents the relative distribution of the parent pixels, and the opacity represents the maximum presence of the parent pixels. For example, a blue pixel of 50% opacity (half present) merged with a red pixel of 100% opacity (fully present) will become a reddish-magenta of 100% opacity.</p>
</blockquote>

<p>First, make sure you have the Registrator open with the tab 'Alphascale' selected and the tab 'Merge multiple' selected therein.</p>

<p><img src="images/tutorial/merge_start.jpg" alt="Screenshot of the Registrator at the tab for merging multiple alphascale images." /></p>

<p>We're going to drag all of the alphascale element maps which we converted in the <a href="#convert-to-alphascale-from-grayscale">previous tutorial step</a> into the Registrator at the same time.</p>

<blockquote>
  <p>The sample images ZIP itself comes with alphascale copies of the element maps. You can use those if you didn't do the previous tutorial steps.</p>
</blockquote>

<p>Select all of the registered alphascale maps by holding Ctrl while left-clicking each file individually (or use Ctrl·A):</p>

<ul>
<li><p><code>s0039V1962_Br_MAXRF_registered_to_s0039V1962_b_crop_alphascale_rgb_241_57_0.png</code> (bromine);</p></li>
<li><p><code>s0039V1962_Cr_MAXRF_registered_to_s0039V1962_b_crop_alphascale_rgb_74_220_41.png</code> (chromium); and</p></li>
<li><p><code>s0039V1962_Zn_MAXRF_registered_to_s0039V1962_b_crop_alphascale_rgb_233_228_228.png</code> (zinc).</p></li>
</ul>

<p>Drag the selected files into the merge area.</p>

<p><img src="images/tutorial/merge_drag.jpg" alt="Screenshot of the Registrator at the tab for merging multiple alphascale images." /></p>

<p>You can zoom and pan the preview to inspect it before saving.</p>

<p>Click 'Save merged image as...', and save the merged alphascale image.</p>

<p>Once finished, close the Registrator — or try registering and converting your own images!</p>

<h2 id="butterfly-viewer">Butterfly Viewer</h2>

<p>The tutorial for the Registrator using the sample images of <a href="#download-sample-van-gogh-images"><em>Small Pear Tree in Blossom</em></a> ends here, but you can continue using those images in the tutorial for <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer<sup>↗</sup></a>.</p>

<p>Butterfly Viewer was created in tandem with the Registrator to allow you to visually inspect and compare images.</p>

<p align="center">
  <img src="images/viewer_alphascale_overlay.gif" alt="Animated screencapture of the Butterfly Viewer showing a sliding overlay with three images being panned and zoomed.">
  <br />
  <i>Sliding overlays</i>
</p>

<p align="center">
  <img src="images/viewer_dragdrop_sync.gif" alt="Animated screencapture of the Butterfly Viewer showing image files loaded via drag-and-drop and then synchronously panned and zoomed.">
  <br />
  <i>Synchronized pan and zoom</i>
</p>

<p>The Viewer leverages the power of images registered with the Registrator for synchronized pan and zoom and sliding overlays. It benefits especially from alphascale-converted images to show the relative distribution of features with respect to reference images, such as XRF and RIS maps laid over color photographs.</p>

<p>The Viewer is available for free as an <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html#windows-executable">installable Windows executable<sup>↗</sup></a>, and it can also be run directly on its <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html#python">Python source code<sup>↗</sup></a>.</p>

<h1 id="common-questions">Common questions</h1>

<h2 id="report-a-bug">Report a bug?</h2>

<p>You can submit a <a href="https://github.com/olive-groves/butterfly_registrator/issues/new/choose">bug report<sup>↗</sup></a> as an issue on the Registrator's GitHub.</p>

<h2 id="request-new-feature">Request new feature?</h2>

<p>You can submit a <a href="https://github.com/olive-groves/butterfly_registrator/issues/new/choose">feature request<sup>↗</sup></a> as an issue on the Registrator's GitHub.</p>

<p><img src="images/tutorial/bug_feature_issue.jpg" alt="GitHub New Issue page showing bug report and feature request options." /></p>

<h2 id="how-does-registration-work">How does registration work?</h2>

<p>Registration works by first designating a reference image, loading the image you wish to align (<em>register</em>) to that reference, automatically resizing and padding it to the dimensions of that reference, and finally applying a perspective transform to match the pairs of control points which you position on both images.</p>

<p>Registered images you save with the Registrator can be opened with any software you use with images, including <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer<sup>↗</sup></a>.</p>

<p><img src="images/tutorial/illustrate_registration.jpg" alt="Illustration of how registration is done in the Registrator." /></p>

<p><img src="images/tutorial/illustrate_registrator.jpg" alt="Illustration itself shown in the Registrator." /></p>

<h2 id="what-is-alphascale">What is alphascale?</h2>

<p>Alphascale is a term we use to refer to a grayscale image converted such that the transparency of each pixel (<em>the alpha channel</em>) is proportional to how black or white the original grayscale pixel is. The color of each pixel in the alphascale image is then set to the same color, like white or red.</p>

<p><img src="images/tutorial/alphascale.png" alt="Gradient bar from white to black in grayscale, white alphascale, and red alphacale." /></p>

<p>For grayscale XRF maps converted to alphascale, this means the transparency represents the presence of an element: an opaque (non-transparent) pixel indicates the highest relative presence, whereas a see-through (transparent) pixel indicates the lowest relative presence. In other words, where in an 8-bit grayscale map white is high (255) and black is low (0), in its alphascale counterpart fully opaque is high (alpha=255) and fully transparent is low (alpha=0).</p>

<p>Butterfly Registrator can <a href="#convert-to-alphascale-from-grayscale">convert images to alphascale</a> as well as <a href="#merge-multiple-alphascale">merge multiple alphascale images</a> into one. You can then use <a href="https://olive-groves.github.io/butterfly_viewer/butterfly_viewer.html">Butterfly Viewer<sup>↗</sup></a> to view those alphascale images with sliding overlays.</p>

<p><img src="images/viewer_alphascale_overlay.gif" alt="Animated screencapture of the Butterfly Viewer showing a sliding overlay with four alphascale element maps being panned and zoomed." /></p>

<h1 id="developers">Developers</h1>

<h2 id="contributing-to-butterfly_registrator">Contributing to <code><a href="">butterfly_registrator</a></code></h2>

<p>You can contribute to <code><a href="">butterfly_registrator</a></code> with a pull request by following these steps:</p>

<ol>
<li>Fork the <a href="https://github.com/olive-groves/butterfly_registrator">repo<sup>↗</sup></a>.</li>
<li>Create a branch: <code>git checkout -b &lt;branch_name&gt;</code>.</li>
<li>Make your changes and commit them: <code>git commit -m '&lt;commit_message&gt;'</code></li>
<li>Push to the original branch: <code>git push origin &lt;project_name&gt;/&lt;location&gt;</code></li>
<li>Create the pull request.</li>
</ol>

<p>Or see the GitHub documentation on <a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/creating-a-pull-request">creating a pull request<sup>↗</sup></a>.</p>

<h2 id="creating-the-executable-and-setup-installer">Creating the executable and setup installer</h2>

<p>The installer executable for Butterfly Registrator is created by first bundling the app with PyInstaller and then creating a setup installer with Inno Setup.</p>

<h3 id="install-pyinstaller">Install PyInstaller</h3>

<p>PyInstaller must be installed with the same packages as the environment of the Butterfly Registrator to bundle a functioning dist and executable.</p>

<p>With <code>conda</code> you can do this by cloning the environment you use for Registrator, activating that clone, and then installing PyInstaller. </p>

<h4 id="cloning-from-env-subfolder">Cloning from <code>env</code> subfolder</h4>

<p>If you use an <code>env</code> subfolder in the root of <code><a href="">butterfly_registrator</a></code> for your Registrator environment, first open Anaconda Prompt and change the directory to the root directory.</p>

<pre><code>cd C:\path\to\the\butterfly_registrator\
</code></pre>

<p>Clone the environment into a new subfolder named <code>env_installer</code>, using the full directory of <code>env</code> in the command.</p>

<pre><code>conda create --prefix ./env_installer --clone C:\path\to\the\butterfly_registrator\env
</code></pre>

<p>Activate the environment.</p>

<pre><code>conda activate ./env_installer
</code></pre>

<h4 id="cloning-from-environmentyml">Cloning from <code>environment.yml</code></h4>

<p>You can also create and activate a clone of the environment directly from the <code>environment.yml</code> in the root directory of <code><a href="">butterfly_registrator</a></code>:</p>

<p>into a subfolder;</p>

<pre><code>conda env create --file environment.yml --prefix ./env_installer
conda activate ./env_installer
</code></pre>

<p>or in a new named environment.</p>

<pre><code>conda env create --file environment.yml --name registrator_installer
conda activate registrator_installer
</code></pre>

<h4 id="install">Install</h4>

<p>With the installer environment activated, install PyInstaller:</p>

<pre><code>conda install pyinstaller
</code></pre>

<h3 id="run-pyinstaller-to-bundle-butterfly-registrator">Run PyInstaller to bundle Butterfly Registrator</h3>

<p>Run PyInstaller with the following command while in the <strong>source code</strong> directory <code>\butterfly_registrator\butterfly_registrator</code>.</p>

<pre><code>cd butterfly_registrator
pyinstaller --onedir --windowed --icon=icons\icon.ico butterfly_registrator.py
</code></pre>

<blockquote>
  <p>PyInstaller not working? Make sure you've changed directory to the source code directory (the subfolder <code><a href="">butterfly_registrator</a></code> within the repo itself).</p>
</blockquote>

<p>The executable runs fastest when not bundled into one file (otherwise it needs to unpack all packages on each startup), so we enforce the default <code>--onedir</code>. We also enforce <code>--windowed</code> to prevent the console window from opening when the executable runs. We add the app icon with the <code>--icon</code> argument.</p>

<h3 id="use-inno-setup-to-create-a-setup-installer">Use Inno Setup to create a setup installer</h3>

<p>Steps to use Inno Setup are not yet documented.</p>

<h2 id="generating-documentation-with-pdoc">Generating documentation with pdoc</h2>

<p>The docs branch is exclusively for generating documentation with pdoc.</p>

<p>In other words, it is a one-way street to docs: only pull main into docs; never pull docs into main.</p>

<blockquote>
  <p>Note: We use <a href="https://pdoc.dev/">pdoc</a>, <em>not</em> pdoc3.</p>
</blockquote>

<h3 id="0-pull-main-into-docs">0. Pull main into docs</h3>

<p>Bring the latest code into the docs branch with a pull request main>docs.</p>

<h3 id="1-checkout-docs-branch">1. Checkout docs branch</h3>

<p>Checkout the docs branch.</p>

<h3 id="2-open-conda-and-change-directory-to-the-root-folder-of-butterfly_registrator">2. Open conda and change directory to the root folder of butterfly_registrator</h3>

<pre><code>cd C:\butterfly_registrator
</code></pre>

<h3 id="3-if-not-yet-done-install-docs-environment">3. (If not yet done) Install docs environment</h3>

<p>Install the docs environment with conda using environment_docs.yml, which is a modified version of the Butterfly Registrator's base environment with pdoc and Python 3.7 (which is required for pdoc). This .yml is available in the docs branch. :</p>

<pre><code>conda env create -f environment_docs.yml --prefix ./env_docs
</code></pre>

<h3 id="4-add-returns-to-pdoc-google-docstring-sections">4. Add <code>"Returns"</code> to pdoc Google docstring sections</h3>

<p>pdoc does not include <strong>Returns</strong> in its list of section headers for Google's docstring style guide. This means the returns are not styled like those under <strong>Arguments</strong>. </p>

<p>To give that styling to returns, do this:</p>

<ol>
<li>Locate <code>docstrings.py</code> in the pdoc site package which installed with the docs environment, likely here:</li>
</ol>

<pre><code>...\env_docs\Lib\site-packages\pdoc\docstrings.py
</code></pre>

<ol start="2">
<li>Add <code>"Returns"</code> to the list variable <code>GOOGLE_LIST_SECTIONS</code>, which is around line 80 or so.</li>
</ol>

<pre><code>GOOGLE_LIST_SECTIONS = ["Args", "Raises", "Attributes", "Returns"]
</code></pre>

<ol start="3">
<li>Save <code>docstrings.py</code></li>
</ol>

<h3 id="5-activate-docs-environment">5. Activate docs environment</h3>

<pre><code>conda activate ./env_docs
</code></pre>

<h3 id="6-add-to-path-the-butterfly_registrator-source-folder">6. Add to path the butterfly_registrator source folder</h3>

<pre><code>set PYTHONPATH=C:\butterfly_registrator\butterfly_registrator
</code></pre>

<h3 id="7-change-directory-to-source-folder">7. Change directory to source folder</h3>

<pre><code>cd butterfly_registrator
</code></pre>

<h3 id="8-run-pdoc">8. Run pdoc</h3>

<p>Run pdoc with the following command while in the source code directory <code>\butterfly_registrator\butterfly_registrator</code>:</p>

<pre><code>pdoc C:\butterfly_registrator\butterfly_registrator -t C:\butterfly_registrator\docs\_templates --docformat google --logo https://olive-groves.github.io/butterfly_registrator/images/registrator_logo.png --logo-link https://olive-groves.github.io/butterfly_registrator/ --favicon https://olive-groves.github.io/butterfly_registrator/images/registrator_logo.png -o C:\butterfly_registrator\docs\
</code></pre>

<blockquote>
  <p>You will need to edit the full directory of the repo in the above pdoc command (<code>C:\butterfly_registrator\...</code>) to match that on your machine.</p>
</blockquote>

<p>We call the custom templates folder with <code>-t</code>. We enforce the google docstring format with <code>--docformat</code>. We add the webpage logo and favicon with <code>--logo</code> and <code>--favicon</code>. We export the docs to the docs subfolder with <code>-o</code>.</p>

<h3 id="9-commit-and-push">9. Commit and push</h3>

<p>Commit and push the updated docs to the docs branch.</p>

<h3 id="10-un-checkout-docs-branch">10. Un-checkout docs branch</h3>

<p>Continue development only after having un-checked out of the docs branch.</p>

<h3 id="multi-line-commands">Multi-line commands</h3>

<p>You can re-run pdoc by copying and pasting the following lines together (steps 2 and 5–8), making sure to replace the absolute paths with those of the repo on your own machine:</p>

<pre><code>cd C:\butterfly_registrator
conda activate ./env_docs
cd butterfly_registrator
set PYTHONPATH=.
pdoc C:\butterfly_registrator\butterfly_registrator -t ../docs/_templates --docformat google --logo https://olive-groves.github.io/butterfly_registrator/images/registrator_logo.png --logo-link https://olive-groves.github.io/butterfly_registrator/ --favicon https://olive-groves.github.io/butterfly_registrator/images/registrator_logo.png -o ../docs
</code></pre>

<h2 id="updating-packages-in-environmentyml">Updating packages in <code>environment.yml</code></h2>

<p>If you change the environment in order to an fix issue, add a feature, or simply reduce a dependency, you can update the packages in the <code>environment.yml</code> of the root by exporting the new environment while it is activated and then replacing that existing YML in the root:</p>

<pre><code>conda activate NAME_OF_ENV

conda install/remove PACKAGE_1
conda install/remove PACKAGE_2
...
conda install/remove PACKAGE_N

conda env export &gt; environment.yml
</code></pre>

<blockquote>
  <p>Take care to update both <code>environment.yml</code> and <code>environment_docs.yml</code> in the branch <code>docs</code>. If unable to do so, please create a GitHub issue requesting it be updated. </p>
</blockquote>

<h1 id="credits">Credits</h1>

<p>Butterfly Registrator is by Lars Maxfield.</p>

<p>Butterfly Registrator uses elements of <a href="https://github.com/tpgit">@tpgit<sup>↗</sup></a>'s <em>PyQt MDI Image Viewer</em> (with changes made), which is made available under the Creative Commons Attribution 3.0 license.</p>

<h1 id="license">License</h1>

<!--- If you're not sure which open license to use see https://choosealicense.com/--->

<p>Butterfly Registrator is made available under the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU GPL v3.0<sup>↗</sup></a> license or later. For the full-text, see the <code>LICENSE.txt</code> file in the root directory of the Registrator's GitHub <a href="https://github.com/olive-groves/butterfly_registrator">repo<sup>↗</sup></a>.</p>
</div>

                        <input id="mod-butterfly_registrator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-butterfly_registrator-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">2</span></a><span class="sd">.. include:: ../docs/DOWNLOAD_TUTORIAL.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">3</span></a><span class="sd">.. include:: ../docs/DEVELOPERS.md</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">4</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">5</span></a><span class="c1"># SPDX-License-Identifier: GPL-3.0-or-later</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">6</span></a><span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
</span></pre></div>


            </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>